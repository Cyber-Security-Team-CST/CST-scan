# CST-scan
# Инструкция по использованию утилиты для сканирования сети

Утилита предназначена для сканирования сети с использованием `masscan` и `nmap`. Она позволяет определять открытые порты, сервисы и уязвимости на указанных IP-адресах. Результаты сканирования сохраняются в Excel-файл.

## Установка

1. Убедитесь, что у вас установлены Python 3 и необходимые зависимости:
   ```bash
   pip install openpyxl tqdm colorama
   ```

2. Установите `masscan` и `nmap`:
   - Для Ubuntu/Debian:
     ```bash
     sudo apt-get install masscan nmap
     ```
   - Для CentOS/RHEL:
     ```bash
     sudo yum install masscan nmap
     ```

## Запуск утилиты

### Основные параметры

- `--ip-list`: Путь к файлу со списком IP-адресов для сканирования (обязательный параметр).
- `--ports-file`: Путь к файлу со списком портов для сканирования (по умолчанию: `top1000ports.txt`).
- `--masscan-output`: Путь к выходному файлу результатов `masscan` (по умолчанию: `ScanIP_list.json`).
- `--nmap-output`: Путь к выходному файлу результатов `nmap` в формате Excel (по умолчанию: `nmap_scan_results.xlsx`).
- `--rate`: Скорость сканирования `masscan` (по умолчанию: 300).
- `--threads`: Количество потоков для выполнения задач (по умолчанию: 40).
- `--timeout`: Таймаут для выполнения каждой задачи в секундах (по умолчанию: 300).
- `--service-scan`: Выполнить только сканирование сервисов.
- `--vuln-scan`: Выполнить только сканирование уязвимостей.
- `--nse-script`: Указать пользовательский скрипт NSE для сканирования.
- `--quiet`: Минимальный вывод информации, только прогресс.

### Примеры использования

1. **Полное сканирование (сервисы и уязвимости)**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt
   ```
   - Сканирует IP-адреса из файла `ip_list.txt`.
   - Использует порты из файла `top1000ports.txt`.
   - Результаты сохраняются в `ScanIP_list.json` и `nmap_scan_results.xlsx`.

2. **Только сканирование сервисов**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt --service-scan
   ```
   - Выполняет только сканирование сервисов.
   - Результаты сохраняются в `nmap_scan_results.xlsx`.

3. **Только сканирование уязвимостей**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt --vuln-scan
   ```
   - Выполняет только сканирование уязвимостей.
   - Результаты сохраняются в `nmap_scan_results.xlsx`.

4. **Использование пользовательского скрипта NSE**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt --nse-script my_script.nse
   ```
   - Использует пользовательский скрипт `my_script.nse` для сканирования уязвимостей.

5. **Минимальный вывод информации**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt --quiet
   ```
   - Выводит только прогресс сканирования.

6. **Указание скорости сканирования и количества потоков**:
   ```bash
   python CST_scan.py --ip-list ip_list.txt --rate 1000 --threads 50
   ```
   - Устанавливает скорость сканирования `masscan` на 1000 пакетов в секунду.
   - Использует 50 потоков для выполнения задач.

### Формат файлов

1. **Файл со списком IP-адресов**:
   - Каждый IP-адрес должен быть на новой строке.
   - Пример:
     ```
     192.168.1.1
     192.168.1.2
     192.168.1.3
     ```

2. **Файл со списком портов**:
   - Каждый порт должен быть на новой строке.
   - Пример:
     ```
     80
     443
     22
     ```

### Результаты сканирования

Результаты сканирования сохраняются в Excel-файл, который содержит два листа:

1. **Services**:
   - Список IP-адресов, портов и обнаруженных сервисов.
   - Пример:
     | IP         | Port | Service | Full Output |
     |------------|------|---------|-------------|
     | 192.168.1.1| 80   | http    | ...         |

2. **Vulnerabilities**:
   - Список IP-адресов, портов и обнаруженных уязвимостей.
   - Пример:
     | IP         | Port | Vulnerability |
     |------------|------|---------------|
     | 192.168.1.1| 80   | CVE-2021-1234 |

### Логирование

Все действия утилиты логируются в файл `nmap_scan.log`.

## Заключение

Утилита предоставляет гибкие возможности для сканирования сети, позволяя выбирать тип сканирования, скорость и количество потоков. Результаты сканирования сохраняются в удобном для анализа формате Excel.
